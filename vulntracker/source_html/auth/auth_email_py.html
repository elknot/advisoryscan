<html><head><title>./auth/auth_email.py</title>
<!-- html produced by lpy.py, http://www.danbala.com -->
<!-- this is the standard header -->
<style>
<!--
a:link { color:blue; text-decoration:none }
a:visited { color:purple; text-decoration:none }
a:active { color:red; text-decoration:none }
a:hover { color:red; text-decoration:none }
-->
</style>
<style>
<--
H3 {    /* need this for navigator */
   font: bold 14pt "Verdana", "Arial", "Helvetica" 
}
div.code { 
    background: #e0e0e0;
    font: 10pt "Courier New", "Courier", "Monaco" 
}
div.doc { 
    font: 10pt "Courier New", "Courier", "Monaco" 
}
td.doc { 
    width:600; 
    font: 9pt "Verdana", "Arial", "Helvetica" 
}
td.xref { 
    font: 9pt "Courier New", "Courier", "Monaco" 
}
table.xref { 
    font: 9pt "Courier New", "Courier", "Monaco" 
}
td.splitdoc { 
    width:50%; 
    font: 9pt "Verdana", "Arial", "Helvetica" 
 }
td.splitcode { 
    width:50%; 
    font: 9pt "Verdana", "Arial", "Helvetica" 
}
-->
</style>
</head>
<body><table><tr><td class="doc"><ul><div class="code"><pre><a name="1">   1</a>    <b>from</b> django.contrib.auth.models <b>import</b> User
<a name="2">   2</a>    <b>from</b> django.core.validators <b>import</b> email_re
<a name="3">   3</a>    
<a name="4">   4</a>    <b>class</b> BasicBackend:
<a name="5">   5</a>        <b>def</b> get_user(<b>self</b>, user_id):
<a name="6">   6</a>            <b>try</b>:
<a name="7">   7</a>                <b>return</b> User.objects.get(pk=user_id)
<a name="8">   8</a>            <b>except</b> User.DoesNotExist:
<a name="9">   9</a>                <b>return</b> None
<a name="10">  10</a>    
<a name="11">  11</a>    <b>class</b> EmailBackend(BasicBackend):
<a name="12">  12</a>        <b>def</b> authenticate(<b>self</b>, username=None, password=None):
<a name="13">  13</a>            <i><font color=green>#If username is an email address, then try to pull it up
</font></i><a name="14">  14</a>            <b>if</b> email_re.search(username):
<a name="15">  15</a>                <b>try</b>:
<a name="16">  16</a>                    user = User.objects.get(email=username)
<a name="17">  17</a>                <b>except</b> User.DoesNotExist:
<a name="18">  18</a>                    <b>return</b> None
<a name="19">  19</a>            <b>else</b>:
<a name="20">  20</a>                <i><font color=green>#We have a non-email address username we should try username
</font></i><a name="21">  21</a>                <b>try</b>:
<a name="22">  22</a>                    user = User.objects.get(username=username)
<a name="23">  23</a>                <b>except</b> User.DoesNotExist:
<a name="24">  24</a>                    <b>return</b> None
<a name="25">  25</a>            <b>if</b> user.check_password(password):
<a name="26">  26</a>                <b>return</b> user</pre></div></ul></td></tr></table></body></html><hr><ul><table><tr><td valign=top><table><tr><td valign=top class="xref">BasicBackend</td><td valign=top class="xref"> <a href="#4">4</a>  <a href="#11">11</a> </td></tr>
<tr><td valign=top class="xref">DoesNotExist</td><td valign=top class="xref"> <a href="#8">8</a>  <a href="#17">17</a>  <a href="#23">23</a> </td></tr>
<tr><td valign=top class="xref">EmailBackend</td><td valign=top class="xref"> <a href="#11">11</a> </td></tr>
<tr><td valign=top class="xref">None</td><td valign=top class="xref"> <a href="#9">9</a>  <a href="#12">12</a>  <a href="#18">18</a>  <a href="#24">24</a> </td></tr>
<tr><td valign=top class="xref">User</td><td valign=top class="xref"> <a href="#1">1</a>  <a href="#7">7</a>  <a href="#8">8</a>  <a href="#16">16</a>  <a href="#17">17</a>  <a href="#22">22</a>  <a href="#23">23</a> </td></tr>
<tr><td valign=top class="xref">auth</td><td valign=top class="xref"> <a href="#1">1</a> </td></tr>
<tr><td valign=top class="xref">authenticate</td><td valign=top class="xref"> <a href="#12">12</a> </td></tr>
<tr><td valign=top class="xref">check_password</td><td valign=top class="xref"> <a href="#25">25</a> </td></tr>
</table></td><td valign=top><table><tr><td valign=top class="xref">contrib</td><td valign=top class="xref"> <a href="#1">1</a> </td></tr>
<tr><td valign=top class="xref">core</td><td valign=top class="xref"> <a href="#2">2</a> </td></tr>
<tr><td valign=top class="xref">django</td><td valign=top class="xref"> <a href="#1">1</a>  <a href="#2">2</a> </td></tr>
<tr><td valign=top class="xref">email</td><td valign=top class="xref"> <a href="#16">16</a> </td></tr>
<tr><td valign=top class="xref">email_re</td><td valign=top class="xref"> <a href="#2">2</a>  <a href="#14">14</a> </td></tr>
<tr><td valign=top class="xref">get</td><td valign=top class="xref"> <a href="#7">7</a>  <a href="#16">16</a>  <a href="#22">22</a> </td></tr>
<tr><td valign=top class="xref">get_user</td><td valign=top class="xref"> <a href="#5">5</a> </td></tr>
<tr><td valign=top class="xref">models</td><td valign=top class="xref"> <a href="#1">1</a> </td></tr>
</table></td><td valign=top><table><tr><td valign=top class="xref">objects</td><td valign=top class="xref"> <a href="#7">7</a>  <a href="#16">16</a>  <a href="#22">22</a> </td></tr>
<tr><td valign=top class="xref">password</td><td valign=top class="xref"> <a href="#12">12</a>  <a href="#25">25</a> </td></tr>
<tr><td valign=top class="xref">pk</td><td valign=top class="xref"> <a href="#7">7</a> </td></tr>
<tr><td valign=top class="xref">search</td><td valign=top class="xref"> <a href="#14">14</a> </td></tr>
<tr><td valign=top class="xref">user</td><td valign=top class="xref"> <a href="#16">16</a>  <a href="#22">22</a>  <a href="#25">25</a>  <a href="#26">26</a> </td></tr>
<tr><td valign=top class="xref">user_id</td><td valign=top class="xref"> <a href="#5">5</a>  <a href="#7">7</a> </td></tr>
<tr><td valign=top class="xref">username</td><td valign=top class="xref"> <a href="#12">12</a>  <a href="#14">14</a>  <a href="#16">16</a>  <a href="#22">22</a> </td></tr>
<tr><td valign=top class="xref">validators</td><td valign=top class="xref"> <a href="#2">2</a> </td></tr>
</table></td></tr></table></ul>