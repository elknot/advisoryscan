<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by perltidy on Mon May 14 17:50:21 2007 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>./model/vuln.class.pl</title>
<style type="text/css">
<!--
/* default style sheet generated by perltidy */
body {background: #FFFFFF; color: #000000}
pre { color: #000000; 
      background: #FFFFFF;
      font-family: courier;
    } 

.c  { color: #228B22;} /* comment */
.cm { color: #000000;} /* comma */
.co { color: #000000;} /* colon */
.h  { color: #CD5555; font-weight:bold;} /* here-doc-target */
.hh { color: #CD5555; font-style:italic;} /* here-doc-text */
.i  { color: #00688B;} /* identifier */
.j  { color: #CD5555; font-weight:bold;} /* label */
.k  { color: #8B008B; font-weight:bold;} /* keyword */
.m  { color: #FF0000; font-weight:bold;} /* subroutine */
.n  { color: #B452CD;} /* numeric */
.p  { color: #000000;} /* paren */
.pd { color: #228B22; font-style:italic;} /* pod-text */
.pu { color: #000000;} /* punctuation */
.q  { color: #CD5555;} /* quote */
.s  { color: #000000;} /* structure */
.sc { color: #000000;} /* semicolon */
.v  { color: #B452CD;} /* v-string */
.w  { color: #000000;} /* bareword */
-->
</style>
</head>
<body>
<a name="-top-"></a>
<h1>./model/vuln.class.pl</h1>
<!-- BEGIN CODE INDEX --><a name="code-index"></a>
<ul>
<li><a href="#package-VulnDB::RDBO::Advisory-">package VulnDB::RDBO::Advisory</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Advisory::Manager-">package VulnDB::RDBO::Advisory::Manager</a>
<ul>
<li><a href="#object_class-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::AlertMethod-">package VulnDB::RDBO::AlertMethod</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::AlertMethod::Manager-">package VulnDB::RDBO::AlertMethod::Manager</a>
<ul>
<li><a href="#object_class-1-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::App-">package VulnDB::RDBO::App</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::App::Manager-">package VulnDB::RDBO::App::Manager</a>
<ul>
<li><a href="#object_class-2-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::AppVersion-">package VulnDB::RDBO::AppVersion</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::AppVersion::Manager-">package VulnDB::RDBO::AppVersion::Manager</a>
<ul>
<li><a href="#object_class-3-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::AuthUser-">package VulnDB::RDBO::AuthUser</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::AuthUser::Manager-">package VulnDB::RDBO::AuthUser::Manager</a>
<ul>
<li><a href="#object_class-4-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::CriteriaType-">package VulnDB::RDBO::CriteriaType</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::CriteriaType::Manager-">package VulnDB::RDBO::CriteriaType::Manager</a>
<ul>
<li><a href="#object_class-5-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Message-">package VulnDB::RDBO::Message</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Message::Manager-">package VulnDB::RDBO::Message::Manager</a>
<ul>
<li><a href="#object_class-6-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::MessageType-">package VulnDB::RDBO::MessageType</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::MessageType::Manager-">package VulnDB::RDBO::MessageType::Manager</a>
<ul>
<li><a href="#object_class-7-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Qualifier-">package VulnDB::RDBO::Qualifier</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Qualifier::Manager-">package VulnDB::RDBO::Qualifier::Manager</a>
<ul>
<li><a href="#object_class-8-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Source-">package VulnDB::RDBO::Source</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::Source::Manager-">package VulnDB::RDBO::Source::Manager</a>
<ul>
<li><a href="#object_class-9-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserAlertMethod-">package VulnDB::RDBO::UserAlertMethod</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserAlertMethod::Manager-">package VulnDB::RDBO::UserAlertMethod::Manager</a>
<ul>
<li><a href="#object_class-10-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserCriteria-">package VulnDB::RDBO::UserCriteria</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserCriteria::Manager-">package VulnDB::RDBO::UserCriteria::Manager</a>
<ul>
<li><a href="#object_class-11-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserMessage-">package VulnDB::RDBO::UserMessage</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserMessage::Manager-">package VulnDB::RDBO::UserMessage::Manager</a>
<ul>
<li><a href="#object_class-12-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserProfile-">package VulnDB::RDBO::UserProfile</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserProfile::Manager-">package VulnDB::RDBO::UserProfile::Manager</a>
<ul>
<li><a href="#object_class-13-">object_class</a></li>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserSource-">package VulnDB::RDBO::UserSource</a>
<ul>
</ul>
</li>
<li><a href="#package-VulnDB::RDBO::UserSource::Manager-">package VulnDB::RDBO::UserSource::Manager</a>
<ul>
<li><a href="#object_class-14-">object_class</a></li>
</ul>
</li>
<li><a href="#EOF-">EOF</a></li>
</ul>
<!-- END CODE INDEX -->
<hr />
<!-- contents of filename: ./model/vuln.class.pl -->
<pre>
   1 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Advisory-"></a>   2 <span class="k">package </span><span class="i">VulnDB::RDBO::Advisory</span><span class="sc">;</span>
   3 
   4 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
   5 
   6 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
   7 
   8 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
   9     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;advisory&#39;</span><span class="cm">,</span>
  10 
  11     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
  12         <span class="w">id</span>         <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  13         <span class="w">message_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  14         <span class="w">app_id</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  15         <span class="w">version</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">25</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  16         <span class="w">text</span>       <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  17     <span class="s">]</span><span class="cm">,</span>
  18 
  19     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
  20 
  21     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
  22         <span class="w">app</span> <span class="cm">=&gt;</span> <span class="s">{</span>
  23             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::App&#39;</span><span class="cm">,</span>
  24             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">app_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
  25         <span class="s">}</span><span class="cm">,</span>
  26 
  27         <span class="w">message</span> <span class="cm">=&gt;</span> <span class="s">{</span>
  28             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Message&#39;</span><span class="cm">,</span>
  29             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">message_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
  30         <span class="s">}</span><span class="cm">,</span>
  31     <span class="s">]</span><span class="cm">,</span>
  32 <span class="s">)</span><span class="sc">;</span>
  33 
  34 <span class="n">1</span><span class="sc">;</span>
  35 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Advisory::Manager-"></a>  36 <span class="k">package </span><span class="i">VulnDB::RDBO::Advisory::Manager</span><span class="sc">;</span>
  37 
  38 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
  39 
  40 <span class="k">use</span> <span class="w">VulnDB::RDBO::Advisory</span><span class="sc">;</span>
  41 
<a name="object_class-"></a>  42 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::Advisory&#39;</span> <span class="s">}</span>
  43 
  44 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;advisory&#39;</span><span class="s">)</span><span class="sc">;</span>
  45 
  46 <span class="n">1</span><span class="sc">;</span>
  47 
  48 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::AlertMethod-"></a>  49 <span class="k">package </span><span class="i">VulnDB::RDBO::AlertMethod</span><span class="sc">;</span>
  50 
  51 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  52 
  53 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
  54 
  55 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
  56     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;alert_method&#39;</span><span class="cm">,</span>
  57 
  58     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
  59         <span class="w">id</span>        <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  60         <span class="w">name</span>      <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  61         <span class="w">desc</span>      <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">100</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  62         <span class="w">desc_long</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
  63     <span class="s">]</span><span class="cm">,</span>
  64 
  65     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
  66 
  67     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;name&#39;</span> <span class="s">]</span><span class="cm">,</span>
  68 
  69     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
  70         <span class="w">userprofiles</span> <span class="cm">=&gt;</span> <span class="s">{</span>
  71             <span class="w">column_map</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">alertmethod_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
  72             <span class="w">foreign_class</span> <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
  73             <span class="w">map_class</span>     <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserAlertMethod&#39;</span><span class="cm">,</span>
  74             <span class="w">map_from</span>      <span class="cm">=&gt;</span> <span class="q">&#39;alertmethod&#39;</span><span class="cm">,</span>
  75             <span class="w">map_to</span>        <span class="cm">=&gt;</span> <span class="q">&#39;userprofile&#39;</span><span class="cm">,</span>
  76             <span class="w">type</span>          <span class="cm">=&gt;</span> <span class="q">&#39;many to many&#39;</span><span class="cm">,</span>
  77         <span class="s">}</span><span class="cm">,</span>
  78     <span class="s">]</span><span class="cm">,</span>
  79 <span class="s">)</span><span class="sc">;</span>
  80 
  81 <span class="n">1</span><span class="sc">;</span>
  82 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::AlertMethod::Manager-"></a>  83 <span class="k">package </span><span class="i">VulnDB::RDBO::AlertMethod::Manager</span><span class="sc">;</span>
  84 
  85 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
  86 
  87 <span class="k">use</span> <span class="w">VulnDB::RDBO::AlertMethod</span><span class="sc">;</span>
  88 
<a name="object_class-1-"></a>  89 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::AlertMethod&#39;</span> <span class="s">}</span>
  90 
  91 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;alert_method&#39;</span><span class="s">)</span><span class="sc">;</span>
  92 
  93 <span class="n">1</span><span class="sc">;</span>
  94 
  95 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::App-"></a>  96 <span class="k">package </span><span class="i">VulnDB::RDBO::App</span><span class="sc">;</span>
  97 
  98 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  99 
 100 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 101 
 102 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 103     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;app&#39;</span><span class="cm">,</span>
 104 
 105     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 106         <span class="w">id</span>   <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 107         <span class="w">name</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">150</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 108     <span class="s">]</span><span class="cm">,</span>
 109 
 110     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 111 
 112     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;name&#39;</span> <span class="s">]</span><span class="cm">,</span>
 113 
 114     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 115         <span class="w">advisory</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 116             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Advisory&#39;</span><span class="cm">,</span>
 117             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;app_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 118             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 119         <span class="s">}</span><span class="cm">,</span>
 120 
 121         <span class="w">app_version</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 122             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::AppVersion&#39;</span><span class="cm">,</span>
 123             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;app_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 124             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 125         <span class="s">}</span><span class="cm">,</span>
 126     <span class="s">]</span><span class="cm">,</span>
 127 <span class="s">)</span><span class="sc">;</span>
 128 
 129 <span class="n">1</span><span class="sc">;</span>
 130 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::App::Manager-"></a> 131 <span class="k">package </span><span class="i">VulnDB::RDBO::App::Manager</span><span class="sc">;</span>
 132 
 133 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 134 
 135 <span class="k">use</span> <span class="w">VulnDB::RDBO::App</span><span class="sc">;</span>
 136 
<a name="object_class-2-"></a> 137 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::App&#39;</span> <span class="s">}</span>
 138 
 139 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;app&#39;</span><span class="s">)</span><span class="sc">;</span>
 140 
 141 <span class="n">1</span><span class="sc">;</span>
 142 
 143 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::AppVersion-"></a> 144 <span class="k">package </span><span class="i">VulnDB::RDBO::AppVersion</span><span class="sc">;</span>
 145 
 146 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 147 
 148 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 149 
 150 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 151     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;app_version&#39;</span><span class="cm">,</span>
 152 
 153     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 154         <span class="w">id</span>      <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 155         <span class="w">app_id</span>  <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 156         <span class="w">version</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 157     <span class="s">]</span><span class="cm">,</span>
 158 
 159     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 160 
 161     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 162         <span class="w">app</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 163             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::App&#39;</span><span class="cm">,</span>
 164             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">app_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 165         <span class="s">}</span><span class="cm">,</span>
 166     <span class="s">]</span><span class="cm">,</span>
 167 <span class="s">)</span><span class="sc">;</span>
 168 
 169 <span class="n">1</span><span class="sc">;</span>
 170 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::AppVersion::Manager-"></a> 171 <span class="k">package </span><span class="i">VulnDB::RDBO::AppVersion::Manager</span><span class="sc">;</span>
 172 
 173 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 174 
 175 <span class="k">use</span> <span class="w">VulnDB::RDBO::AppVersion</span><span class="sc">;</span>
 176 
<a name="object_class-3-"></a> 177 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::AppVersion&#39;</span> <span class="s">}</span>
 178 
 179 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;app_version&#39;</span><span class="s">)</span><span class="sc">;</span>
 180 
 181 <span class="n">1</span><span class="sc">;</span>
 182 
 183 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::AuthUser-"></a> 184 <span class="k">package </span><span class="i">VulnDB::RDBO::AuthUser</span><span class="sc">;</span>
 185 
 186 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 187 
 188 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 189 
 190 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 191     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;auth_user&#39;</span><span class="cm">,</span>
 192 
 193     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 194         <span class="w">id</span>           <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 195         <span class="w">username</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">30</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 196         <span class="w">first_name</span>   <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">30</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 197         <span class="w">last_name</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">30</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 198         <span class="w">email</span>        <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">75</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 199         <span class="w">password</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">128</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 200         <span class="w">is_staff</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 201         <span class="w">is_active</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 202         <span class="w">is_superuser</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 203         <span class="w">last_login</span>   <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;datetime&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 204         <span class="w">date_joined</span>  <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;datetime&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 205     <span class="s">]</span><span class="cm">,</span>
 206 
 207     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 208 
 209     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;username&#39;</span> <span class="s">]</span><span class="cm">,</span>
 210 
 211     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 212         <span class="w">user_criteria</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 213             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserCriteria&#39;</span><span class="cm">,</span>
 214             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;user_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 215             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 216         <span class="s">}</span><span class="cm">,</span>
 217 
 218         <span class="w">user_profile</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 219             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
 220             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;user_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 221             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to one&#39;</span><span class="cm">,</span>
 222         <span class="s">}</span><span class="cm">,</span>
 223     <span class="s">]</span><span class="cm">,</span>
 224 <span class="s">)</span><span class="sc">;</span>
 225 
 226 <span class="n">1</span><span class="sc">;</span>
 227 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::AuthUser::Manager-"></a> 228 <span class="k">package </span><span class="i">VulnDB::RDBO::AuthUser::Manager</span><span class="sc">;</span>
 229 
 230 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 231 
 232 <span class="k">use</span> <span class="w">VulnDB::RDBO::AuthUser</span><span class="sc">;</span>
 233 
<a name="object_class-4-"></a> 234 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::AuthUser&#39;</span> <span class="s">}</span>
 235 
 236 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;auth_user&#39;</span><span class="s">)</span><span class="sc">;</span>
 237 
 238 <span class="n">1</span><span class="sc">;</span>
 239 
 240 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::CriteriaType-"></a> 241 <span class="k">package </span><span class="i">VulnDB::RDBO::CriteriaType</span><span class="sc">;</span>
 242 
 243 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 244 
 245 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 246 
 247 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 248     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;criteria_type&#39;</span><span class="cm">,</span>
 249 
 250     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 251         <span class="w">id</span>                 <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 252         <span class="w">name</span>               <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 253         <span class="w">search_field</span>       <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">100</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 254         <span class="w">desc</span>               <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 255         <span class="w">input_type</span>         <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 256         <span class="w">criteria_pref_type</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;advanced&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 257     <span class="s">]</span><span class="cm">,</span>
 258 
 259     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 260 
 261     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;name&#39;</span> <span class="s">]</span><span class="cm">,</span>
 262 
 263     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 264         <span class="w">user_criteria</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 265             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserCriteria&#39;</span><span class="cm">,</span>
 266             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;criteria_type_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 267             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 268         <span class="s">}</span><span class="cm">,</span>
 269     <span class="s">]</span><span class="cm">,</span>
 270 <span class="s">)</span><span class="sc">;</span>
 271 
 272 <span class="n">1</span><span class="sc">;</span>
 273 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::CriteriaType::Manager-"></a> 274 <span class="k">package </span><span class="i">VulnDB::RDBO::CriteriaType::Manager</span><span class="sc">;</span>
 275 
 276 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 277 
 278 <span class="k">use</span> <span class="w">VulnDB::RDBO::CriteriaType</span><span class="sc">;</span>
 279 
<a name="object_class-5-"></a> 280 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::CriteriaType&#39;</span> <span class="s">}</span>
 281 
 282 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;criteria_type&#39;</span><span class="s">)</span><span class="sc">;</span>
 283 
 284 <span class="n">1</span><span class="sc">;</span>
 285 
 286 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Message-"></a> 287 <span class="k">package </span><span class="i">VulnDB::RDBO::Message</span><span class="sc">;</span>
 288 
 289 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 290 
 291 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 292 
 293 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 294     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;message&#39;</span><span class="cm">,</span>
 295 
 296     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 297         <span class="w">id</span>              <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 298         <span class="w">text</span>            <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 299         <span class="w">subject</span>         <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">250</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 300         <span class="w">body</span>            <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 301         <span class="w">message_type_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 302         <span class="w">source_id</span>       <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 303         <span class="w">is_processed</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 304         <span class="w">is_mailed</span>       <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 305     <span class="s">]</span><span class="cm">,</span>
 306 
 307     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 308 
 309     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 310         <span class="w">message_type</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 311             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::MessageType&#39;</span><span class="cm">,</span>
 312             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">message_type_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 313         <span class="s">}</span><span class="cm">,</span>
 314 
 315         <span class="w">source</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 316             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Source&#39;</span><span class="cm">,</span>
 317             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">source_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 318         <span class="s">}</span><span class="cm">,</span>
 319     <span class="s">]</span><span class="cm">,</span>
 320 
 321     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 322         <span class="w">advisory</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 323             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Advisory&#39;</span><span class="cm">,</span>
 324             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;message_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 325             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 326         <span class="s">}</span><span class="cm">,</span>
 327 
 328         <span class="w">userprofiles</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 329             <span class="w">column_map</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">message_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 330             <span class="w">foreign_class</span> <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
 331             <span class="w">map_class</span>     <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserMessage&#39;</span><span class="cm">,</span>
 332             <span class="w">map_from</span>      <span class="cm">=&gt;</span> <span class="q">&#39;message&#39;</span><span class="cm">,</span>
 333             <span class="w">map_to</span>        <span class="cm">=&gt;</span> <span class="q">&#39;userprofile&#39;</span><span class="cm">,</span>
 334             <span class="w">type</span>          <span class="cm">=&gt;</span> <span class="q">&#39;many to many&#39;</span><span class="cm">,</span>
 335         <span class="s">}</span><span class="cm">,</span>
 336     <span class="s">]</span><span class="cm">,</span>
 337 <span class="s">)</span><span class="sc">;</span>
 338 
 339 <span class="n">1</span><span class="sc">;</span>
 340 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Message::Manager-"></a> 341 <span class="k">package </span><span class="i">VulnDB::RDBO::Message::Manager</span><span class="sc">;</span>
 342 
 343 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 344 
 345 <span class="k">use</span> <span class="w">VulnDB::RDBO::Message</span><span class="sc">;</span>
 346 
<a name="object_class-6-"></a> 347 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::Message&#39;</span> <span class="s">}</span>
 348 
 349 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;message&#39;</span><span class="s">)</span><span class="sc">;</span>
 350 
 351 <span class="n">1</span><span class="sc">;</span>
 352 
 353 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::MessageType-"></a> 354 <span class="k">package </span><span class="i">VulnDB::RDBO::MessageType</span><span class="sc">;</span>
 355 
 356 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 357 
 358 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 359 
 360 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 361     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;message_type&#39;</span><span class="cm">,</span>
 362 
 363     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 364         <span class="w">id</span>   <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 365         <span class="w">name</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">25</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 366         <span class="w">desc</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 367     <span class="s">]</span><span class="cm">,</span>
 368 
 369     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 370 
 371     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;name&#39;</span> <span class="s">]</span><span class="cm">,</span>
 372 
 373     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 374         <span class="w">message</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 375             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Message&#39;</span><span class="cm">,</span>
 376             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;message_type_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 377             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 378         <span class="s">}</span><span class="cm">,</span>
 379 
 380         <span class="w">source</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 381             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Source&#39;</span><span class="cm">,</span>
 382             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;message_type_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 383             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 384         <span class="s">}</span><span class="cm">,</span>
 385     <span class="s">]</span><span class="cm">,</span>
 386 <span class="s">)</span><span class="sc">;</span>
 387 
 388 <span class="n">1</span><span class="sc">;</span>
 389 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::MessageType::Manager-"></a> 390 <span class="k">package </span><span class="i">VulnDB::RDBO::MessageType::Manager</span><span class="sc">;</span>
 391 
 392 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 393 
 394 <span class="k">use</span> <span class="w">VulnDB::RDBO::MessageType</span><span class="sc">;</span>
 395 
<a name="object_class-7-"></a> 396 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::MessageType&#39;</span> <span class="s">}</span>
 397 
 398 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;message_type&#39;</span><span class="s">)</span><span class="sc">;</span>
 399 
 400 <span class="n">1</span><span class="sc">;</span>
 401 
 402 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Qualifier-"></a> 403 <span class="k">package </span><span class="i">VulnDB::RDBO::Qualifier</span><span class="sc">;</span>
 404 
 405 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 406 
 407 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 408 
 409 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 410     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;qualifier&#39;</span><span class="cm">,</span>
 411 
 412     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 413         <span class="w">id</span>       <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 414         <span class="w">name</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 415         <span class="w">desc</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">150</span> <span class="s">}</span><span class="cm">,</span>
 416         <span class="w">sql</span>      <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">150</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 417         <span class="w">rose</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 418         <span class="w">rose_sql</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 419     <span class="s">]</span><span class="cm">,</span>
 420 
 421     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 422 
 423     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 424         <span class="w">user_criteria</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 425             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserCriteria&#39;</span><span class="cm">,</span>
 426             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;qualifier_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 427             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 428         <span class="s">}</span><span class="cm">,</span>
 429     <span class="s">]</span><span class="cm">,</span>
 430 <span class="s">)</span><span class="sc">;</span>
 431 
 432 <span class="n">1</span><span class="sc">;</span>
 433 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Qualifier::Manager-"></a> 434 <span class="k">package </span><span class="i">VulnDB::RDBO::Qualifier::Manager</span><span class="sc">;</span>
 435 
 436 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 437 
 438 <span class="k">use</span> <span class="w">VulnDB::RDBO::Qualifier</span><span class="sc">;</span>
 439 
<a name="object_class-8-"></a> 440 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::Qualifier&#39;</span> <span class="s">}</span>
 441 
 442 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;qualifier&#39;</span><span class="s">)</span><span class="sc">;</span>
 443 
 444 <span class="n">1</span><span class="sc">;</span>
 445 
 446 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Source-"></a> 447 <span class="k">package </span><span class="i">VulnDB::RDBO::Source</span><span class="sc">;</span>
 448 
 449 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 450 
 451 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 452 
 453 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 454     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;source&#39;</span><span class="cm">,</span>
 455 
 456     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 457         <span class="w">id</span>              <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 458         <span class="w">name</span>            <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 459         <span class="w">email</span>           <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 460         <span class="w">email_password</span>  <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 461         <span class="w">email_server</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 462         <span class="w">url</span>             <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">100</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 463         <span class="w">desc</span>            <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">150</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 464         <span class="w">desc_long</span>       <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;scalar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">4294967295</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 465         <span class="w">message_type_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 466     <span class="s">]</span><span class="cm">,</span>
 467 
 468     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 469 
 470     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;name&#39;</span><span class="cm">,</span> <span class="q">&#39;message_type_id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 471 
 472     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 473         <span class="w">message_type</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 474             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::MessageType&#39;</span><span class="cm">,</span>
 475             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">message_type_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 476         <span class="s">}</span><span class="cm">,</span>
 477     <span class="s">]</span><span class="cm">,</span>
 478 
 479     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 480         <span class="w">message</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 481             <span class="w">class</span>      <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Message&#39;</span><span class="cm">,</span>
 482             <span class="w">column_map</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">id</span> <span class="cm">=&gt;</span> <span class="q">&#39;source_id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 483             <span class="w">type</span>       <span class="cm">=&gt;</span> <span class="q">&#39;one to many&#39;</span><span class="cm">,</span>
 484         <span class="s">}</span><span class="cm">,</span>
 485 
 486         <span class="w">userprofiles</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 487             <span class="w">column_map</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">source_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 488             <span class="w">foreign_class</span> <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
 489             <span class="w">map_class</span>     <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserSource&#39;</span><span class="cm">,</span>
 490             <span class="w">map_from</span>      <span class="cm">=&gt;</span> <span class="q">&#39;source&#39;</span><span class="cm">,</span>
 491             <span class="w">map_to</span>        <span class="cm">=&gt;</span> <span class="q">&#39;userprofile&#39;</span><span class="cm">,</span>
 492             <span class="w">type</span>          <span class="cm">=&gt;</span> <span class="q">&#39;many to many&#39;</span><span class="cm">,</span>
 493         <span class="s">}</span><span class="cm">,</span>
 494     <span class="s">]</span><span class="cm">,</span>
 495 <span class="s">)</span><span class="sc">;</span>
 496 
 497 <span class="n">1</span><span class="sc">;</span>
 498 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::Source::Manager-"></a> 499 <span class="k">package </span><span class="i">VulnDB::RDBO::Source::Manager</span><span class="sc">;</span>
 500 
 501 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 502 
 503 <span class="k">use</span> <span class="w">VulnDB::RDBO::Source</span><span class="sc">;</span>
 504 
<a name="object_class-9-"></a> 505 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::Source&#39;</span> <span class="s">}</span>
 506 
 507 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;source&#39;</span><span class="s">)</span><span class="sc">;</span>
 508 
 509 <span class="n">1</span><span class="sc">;</span>
 510 
 511 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserAlertMethod-"></a> 512 <span class="k">package </span><span class="i">VulnDB::RDBO::UserAlertMethod</span><span class="sc">;</span>
 513 
 514 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 515 
 516 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 517 
 518 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 519     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;user_alert_methods&#39;</span><span class="cm">,</span>
 520 
 521     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 522         <span class="w">id</span>             <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 523         <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 524         <span class="w">alertmethod_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 525     <span class="s">]</span><span class="cm">,</span>
 526 
 527     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 528 
 529     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;userprofile_id&#39;</span><span class="cm">,</span> <span class="q">&#39;alertmethod_id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 530 
 531     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 532         <span class="w">alertmethod</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 533             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::AlertMethod&#39;</span><span class="cm">,</span>
 534             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">alertmethod_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 535         <span class="s">}</span><span class="cm">,</span>
 536 
 537         <span class="w">userprofile</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 538             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
 539             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 540         <span class="s">}</span><span class="cm">,</span>
 541     <span class="s">]</span><span class="cm">,</span>
 542 <span class="s">)</span><span class="sc">;</span>
 543 
 544 <span class="n">1</span><span class="sc">;</span>
 545 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserAlertMethod::Manager-"></a> 546 <span class="k">package </span><span class="i">VulnDB::RDBO::UserAlertMethod::Manager</span><span class="sc">;</span>
 547 
 548 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 549 
 550 <span class="k">use</span> <span class="w">VulnDB::RDBO::UserAlertMethod</span><span class="sc">;</span>
 551 
<a name="object_class-10-"></a> 552 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::UserAlertMethod&#39;</span> <span class="s">}</span>
 553 
 554 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;user_alert_methods&#39;</span><span class="s">)</span><span class="sc">;</span>
 555 
 556 <span class="n">1</span><span class="sc">;</span>
 557 
 558 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserCriteria-"></a> 559 <span class="k">package </span><span class="i">VulnDB::RDBO::UserCriteria</span><span class="sc">;</span>
 560 
 561 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 562 
 563 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 564 
 565 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 566     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;user_criteria&#39;</span><span class="cm">,</span>
 567 
 568     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 569         <span class="w">id</span>               <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 570         <span class="w">user_id</span>          <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 571         <span class="w">criteria_type_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 572         <span class="w">qualifier_id</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 573         <span class="w">value</span>            <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 574     <span class="s">]</span><span class="cm">,</span>
 575 
 576     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 577 
 578     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 579         <span class="w">criteria_type</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 580             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::CriteriaType&#39;</span><span class="cm">,</span>
 581             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">criteria_type_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 582         <span class="s">}</span><span class="cm">,</span>
 583 
 584         <span class="w">qualifier</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 585             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Qualifier&#39;</span><span class="cm">,</span>
 586             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">qualifier_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 587         <span class="s">}</span><span class="cm">,</span>
 588 
 589         <span class="w">user</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 590             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::AuthUser&#39;</span><span class="cm">,</span>
 591             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">user_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 592         <span class="s">}</span><span class="cm">,</span>
 593     <span class="s">]</span><span class="cm">,</span>
 594 <span class="s">)</span><span class="sc">;</span>
 595 
 596 <span class="n">1</span><span class="sc">;</span>
 597 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserCriteria::Manager-"></a> 598 <span class="k">package </span><span class="i">VulnDB::RDBO::UserCriteria::Manager</span><span class="sc">;</span>
 599 
 600 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 601 
 602 <span class="k">use</span> <span class="w">VulnDB::RDBO::UserCriteria</span><span class="sc">;</span>
 603 
<a name="object_class-11-"></a> 604 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::UserCriteria&#39;</span> <span class="s">}</span>
 605 
 606 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;user_criteria&#39;</span><span class="s">)</span><span class="sc">;</span>
 607 
 608 <span class="n">1</span><span class="sc">;</span>
 609 
 610 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserMessage-"></a> 611 <span class="k">package </span><span class="i">VulnDB::RDBO::UserMessage</span><span class="sc">;</span>
 612 
 613 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 614 
 615 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 616 
 617 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 618     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;user_messages&#39;</span><span class="cm">,</span>
 619 
 620     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 621         <span class="w">id</span>             <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 622         <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 623         <span class="w">message_id</span>     <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 624     <span class="s">]</span><span class="cm">,</span>
 625 
 626     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 627 
 628     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;userprofile_id&#39;</span><span class="cm">,</span> <span class="q">&#39;message_id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 629 
 630     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 631         <span class="w">message</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 632             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Message&#39;</span><span class="cm">,</span>
 633             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">message_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 634         <span class="s">}</span><span class="cm">,</span>
 635 
 636         <span class="w">userprofile</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 637             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
 638             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 639         <span class="s">}</span><span class="cm">,</span>
 640     <span class="s">]</span><span class="cm">,</span>
 641 <span class="s">)</span><span class="sc">;</span>
 642 
 643 <span class="n">1</span><span class="sc">;</span>
 644 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserMessage::Manager-"></a> 645 <span class="k">package </span><span class="i">VulnDB::RDBO::UserMessage::Manager</span><span class="sc">;</span>
 646 
 647 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 648 
 649 <span class="k">use</span> <span class="w">VulnDB::RDBO::UserMessage</span><span class="sc">;</span>
 650 
<a name="object_class-12-"></a> 651 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::UserMessage&#39;</span> <span class="s">}</span>
 652 
 653 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;user_messages&#39;</span><span class="s">)</span><span class="sc">;</span>
 654 
 655 <span class="n">1</span><span class="sc">;</span>
 656 
 657 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserProfile-"></a> 658 <span class="k">package </span><span class="i">VulnDB::RDBO::UserProfile</span><span class="sc">;</span>
 659 
 660 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 661 
 662 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 663 
 664 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 665     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;user_profile&#39;</span><span class="cm">,</span>
 666 
 667     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 668         <span class="w">id</span>                 <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 669         <span class="w">user_id</span>            <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 670         <span class="w">where_heard</span>        <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">250</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 671         <span class="w">criteria_pref_type</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;varchar&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;simple&#39;</span><span class="cm">,</span> <span class="w">length</span> <span class="cm">=&gt;</span> <span class="n">50</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 672     <span class="s">]</span><span class="cm">,</span>
 673 
 674     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 675 
 676     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;user_id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 677 
 678     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 679         <span class="w">user</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 680             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::AuthUser&#39;</span><span class="cm">,</span>
 681             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">user_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 682             <span class="w">rel_type</span>    <span class="cm">=&gt;</span> <span class="q">&#39;one to one&#39;</span><span class="cm">,</span>
 683         <span class="s">}</span><span class="cm">,</span>
 684     <span class="s">]</span><span class="cm">,</span>
 685 
 686     <span class="w">relationships</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 687         <span class="w">alertmethods</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 688             <span class="w">column_map</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 689             <span class="w">foreign_class</span> <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::AlertMethod&#39;</span><span class="cm">,</span>
 690             <span class="w">map_class</span>     <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserAlertMethod&#39;</span><span class="cm">,</span>
 691             <span class="w">map_from</span>      <span class="cm">=&gt;</span> <span class="q">&#39;userprofile&#39;</span><span class="cm">,</span>
 692             <span class="w">map_to</span>        <span class="cm">=&gt;</span> <span class="q">&#39;alertmethod&#39;</span><span class="cm">,</span>
 693             <span class="w">type</span>          <span class="cm">=&gt;</span> <span class="q">&#39;many to many&#39;</span><span class="cm">,</span>
 694         <span class="s">}</span><span class="cm">,</span>
 695 
 696         <span class="w">messages</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 697             <span class="w">column_map</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 698             <span class="w">foreign_class</span> <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Message&#39;</span><span class="cm">,</span>
 699             <span class="w">map_class</span>     <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserMessage&#39;</span><span class="cm">,</span>
 700             <span class="w">map_from</span>      <span class="cm">=&gt;</span> <span class="q">&#39;userprofile&#39;</span><span class="cm">,</span>
 701             <span class="w">map_to</span>        <span class="cm">=&gt;</span> <span class="q">&#39;message&#39;</span><span class="cm">,</span>
 702             <span class="w">type</span>          <span class="cm">=&gt;</span> <span class="q">&#39;many to many&#39;</span><span class="cm">,</span>
 703         <span class="s">}</span><span class="cm">,</span>
 704 
 705         <span class="w">sources</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 706             <span class="w">column_map</span>    <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 707             <span class="w">foreign_class</span> <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Source&#39;</span><span class="cm">,</span>
 708             <span class="w">map_class</span>     <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserSource&#39;</span><span class="cm">,</span>
 709             <span class="w">map_from</span>      <span class="cm">=&gt;</span> <span class="q">&#39;userprofile&#39;</span><span class="cm">,</span>
 710             <span class="w">map_to</span>        <span class="cm">=&gt;</span> <span class="q">&#39;source&#39;</span><span class="cm">,</span>
 711             <span class="w">type</span>          <span class="cm">=&gt;</span> <span class="q">&#39;many to many&#39;</span><span class="cm">,</span>
 712         <span class="s">}</span><span class="cm">,</span>
 713     <span class="s">]</span><span class="cm">,</span>
 714 <span class="s">)</span><span class="sc">;</span>
 715 
 716 <span class="n">1</span><span class="sc">;</span>
 717 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserProfile::Manager-"></a> 718 <span class="k">package </span><span class="i">VulnDB::RDBO::UserProfile::Manager</span><span class="sc">;</span>
 719 
 720 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 721 
 722 <span class="k">use</span> <span class="w">VulnDB::RDBO::UserProfile</span><span class="sc">;</span>
 723 
<a name="object_class-13-"></a> 724 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span> <span class="s">}</span>
 725 
 726 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;user_profile&#39;</span><span class="s">)</span><span class="sc">;</span>
 727 
 728 <span class="n">1</span><span class="sc">;</span>
 729 
 730 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserSource-"></a> 731 <span class="k">package </span><span class="i">VulnDB::RDBO::UserSource</span><span class="sc">;</span>
 732 
 733 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
 734 
 735 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(VulnDB::RDBO)</span><span class="sc">;</span>
 736 
 737 <span class="w">__PACKAGE__</span><span class="w">-&gt;meta</span><span class="w">-&gt;setup</span><span class="s">(</span>
 738     <span class="w">table</span>   <span class="cm">=&gt;</span> <span class="q">&#39;user_sources&#39;</span><span class="cm">,</span>
 739 
 740     <span class="w">columns</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 741         <span class="w">id</span>             <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 742         <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 743         <span class="w">source_id</span>      <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">type</span> <span class="cm">=&gt;</span> <span class="q">&#39;integer&#39;</span><span class="cm">,</span> <span class="w">default</span> <span class="cm">=&gt;</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="w">not_null</span> <span class="cm">=&gt;</span> <span class="n">1</span> <span class="s">}</span><span class="cm">,</span>
 744     <span class="s">]</span><span class="cm">,</span>
 745 
 746     <span class="w">primary_key_columns</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 747 
 748     <span class="w">unique_key</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;userprofile_id&#39;</span><span class="cm">,</span> <span class="q">&#39;source_id&#39;</span> <span class="s">]</span><span class="cm">,</span>
 749 
 750     <span class="w">foreign_keys</span> <span class="cm">=&gt;</span> <span class="s">[</span>
 751         <span class="w">source</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 752             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::Source&#39;</span><span class="cm">,</span>
 753             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">source_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 754         <span class="s">}</span><span class="cm">,</span>
 755 
 756         <span class="w">userprofile</span> <span class="cm">=&gt;</span> <span class="s">{</span>
 757             <span class="w">class</span>       <span class="cm">=&gt;</span> <span class="q">&#39;VulnDB::RDBO::UserProfile&#39;</span><span class="cm">,</span>
 758             <span class="w">key_columns</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">userprofile_id</span> <span class="cm">=&gt;</span> <span class="q">&#39;id&#39;</span> <span class="s">}</span><span class="cm">,</span>
 759         <span class="s">}</span><span class="cm">,</span>
 760     <span class="s">]</span><span class="cm">,</span>
 761 <span class="s">)</span><span class="sc">;</span>
 762 
 763 <span class="n">1</span><span class="sc">;</span>
 764 <span class="c">######################################################################</span>
<a name="package-VulnDB::RDBO::UserSource::Manager-"></a> 765 <span class="k">package </span><span class="i">VulnDB::RDBO::UserSource::Manager</span><span class="sc">;</span>
 766 
 767 <span class="k">use</span> <span class="w">base</span> <span class="q">qw(Rose::DB::Object::Manager)</span><span class="sc">;</span>
 768 
 769 <span class="k">use</span> <span class="w">VulnDB::RDBO::UserSource</span><span class="sc">;</span>
 770 
<a name="object_class-14-"></a> 771 <span class="k">sub </span><span class="m">object_class</span> <span class="s">{</span> <span class="q">&#39;VulnDB::RDBO::UserSource&#39;</span> <span class="s">}</span>
 772 
 773 <span class="w">__PACKAGE__</span><span class="w">-&gt;make_manager_methods</span><span class="s">(</span><span class="q">&#39;user_sources&#39;</span><span class="s">)</span><span class="sc">;</span>
 774 
 775 <span class="n">1</span><span class="sc">;</span>
 776 
<a name="EOF-"></a></pre>
</body>
</html>
